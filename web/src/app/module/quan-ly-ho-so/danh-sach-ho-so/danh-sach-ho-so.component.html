<form [formGroup]="myForm">
  <div class="p-b-20">
    <div fxLayout="row" fxLayoutGap="2%" fxLayout.xs="column">
      <input-text
        [fxFlex]="isShowAdvanced ? '74.5%' : '60%'"
        label="Từ khóa tìm kiếm"
        placeholder="Tên sản phẩm vay"
        formControlName="productLoanCtrl"
        icon="search"
      >
      </input-text>
      <input-from-to-date
        label="Ngày tạo hồ sơ"
        fxFlex="23.5%"
        isRight="true"
        formControlName="createFromToCtrl"
        readonly="true"
      >
      </input-from-to-date>
      <ng-container *ngIf="!isShowAdvanced">
        <div fxFlex="18%">
          <div style="height: 28px"></div>
          <button
            class="btn btn-block btn-default"
            type="button"
            (click)="setShowAdvanced(true)"
          >
            Tìm kiếm nâng cao
          </button>
        </div>
      </ng-container>
    </div>
    <ng-container *ngIf="!isShowAdvanced && isAdmin()">
      <div fxLayout="row" fxLayoutGap="2%" fxLayout.xs="column">
        <button class="btn btn-danger" type="button" (click)="onCancel()">
          Hủy hồ sơ đã chọn
        </button>
      </div>
    </ng-container>
    <ng-container *ngIf="isShowAdvanced">
      <div fxLayout="row" fxLayoutGap="2%" fxLayout.xs="column">
        <input-text
          fxFlex="25.5%"
          label="ID Number"
          formControlName="idNumberCtrl"
        >
        </input-text>
        <input-text
          fxFlex="25.5%"
          label="Họ tên khách hàng"
          formControlName="fullNameCtrl"
        >
        </input-text>
        <input-text
          fxFlex="25.5%"
          label="Số điện thoại"
          formControlName="phoneNumberCtrl"
        >
        </input-text>
        <input-select
          label="Hồ sơ phân loại khách hàng"
          fxFlex="23.5%"
          [items]="listClassifyCustomer"
          keyDisplay="name"
          formControlName="classifyCutomerCtrl"
        ></input-select>
      </div>
      <div fxLayout="row" fxLayoutGap="2%" fxLayout.xs="column">
        <input-select
          label="Hình thức cho vay"
          [items]="listLoanForm"
          keyDisplay="name"
          fxFlex="23.5%"
          formControlName="loanFormCtrl"
        ></input-select>
        <input-select
          label="Loại khách hàng"
          [items]="listTypeCustomer"
          keyDisplay="name"
          fxFlex="23.5%"
          formControlName="typeCustomerCtrl"
        ></input-select>
        <input-select
          label="Hình thức thanh toán"
          [items]="listFormPayment"
          keyDisplay="name"
          formControlName="formPaymentCtrl"
          fxFlex="23.5%"
        ></input-select>
        <input-select
          label="Loại khách khoản vay"
          [items]="listTypeOfLoan"
          keyDisplay="name"
          formControlName="typeOfLoanCtrl"
          fxFlex="23.5%"
        ></input-select>
      </div>
      <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="2%">
        <div>
          <button type="button" class="btn btn-primary" (click)="onSearch()">
            <i class="fa fa-search"></i>Tìm kiếm
          </button>
        </div>
      <ng-container *ngIf="isAdmin()">
        <div>
          <button class="btn btn-danger" type="button" (click)="onCancel()">
            Hủy hồ sơ đã chọn
          </button>
        </div>
      </ng-container>
        <div>
          <button
            class="btn btn-block btn-default"
            type="button"
            (click)="setShowAdvanced(false)"
          >
            Ẩn tìm kiếm nâng cao
          </button>
        </div>
      </div>
    </ng-container>
  </div>
</form>

<div class="full-width p-b-20">
  <table mat-table [dataSource]="lstResult">
    <ng-container matColumnDef="postion">
      <th mat-header-cell *matHeaderCellDef>STT</th>
      <td mat-cell *matCellDef="let row; let i = index">{{ i + 1 }}</td>
    </ng-container>

    <ng-container matColumnDef="checked">
      <th mat-header-cell *matHeaderCellDef style="padding-left: 0 !important">
        <mat-checkbox
          (change)="$event ? masterToggle() : null"
          [checked]="selection.hasValue() && isAllSelected()"
          [indeterminate]="selection.hasValue() && !isAllSelected()"
        >
        </mat-checkbox>
      </th>
      <td
        mat-cell
        *matCellDef="let row; let i = index"
        style="padding-left: 0 !important"
      >
        <mat-checkbox
          (click)="$event.stopPropagation()"
          (change)="$event ? selection.toggle(row) : null"
          [checked]="selection.isSelected(row)"
        >
        </mat-checkbox>
      </td>
    </ng-container>

    <ng-container matColumnDef="id_number">
      <th mat-header-cell *matHeaderCellDef>ID Number</th>
      <td mat-cell *matCellDef="let item">{{ item.id_number }}</td>
    </ng-container>

    <ng-container matColumnDef="fullname">
      <th mat-header-cell *matHeaderCellDef>Tên khách hàng</th>
      <td mat-cell *matCellDef="let item">
        {{ item.fullname }}
      </td>
    </ng-container>

    <ng-container matColumnDef="scope">
      <th mat-header-cell *matHeaderCellDef>Phạm vi</th>
      <td mat-cell *matCellDef="let item">{{ item.scope }}</td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Trạng thái</th>
      <td mat-cell *matCellDef="let item">{{ getStatusName(item.status) }}</td>
    </ng-container>

    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef>Hành động</th>
      <td mat-cell *matCellDef="let row">
        <button mat-icon-button [matMenuTriggerFor]="menu">
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item (click)="showDetail(row)">
            <span>Chi tiết</span>
          </button>
          <button mat-menu-item disabled>
            <span>Lưu trữ</span>
          </button>
          <button mat-menu-item>
            <span>Hoàn thiện hồ sơ</span>
          </button>
        </mat-menu>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr
      mat-row
      *matRowDef="let row; columns: displayedColumns"
      (click)="showDetail(row)"
      style="cursor: pointer"
    ></tr>

    <!-- Row shown when there is no matching data. -->
    <!-- <tr class="mat-row" *matNoDataRow>
      <td class="mat-cell" colspan="4">
        No data matching the filter "{{ input.value }}"
      </td>
    </tr> -->
  </table>
  <div class="add-view">
    <a href="javascript:void(0)" (click)="seeMore()" *ngIf="isShowLoadMore"
      >Xem thêm <i class="fa fa-spinner fa-spin" *ngIf="isShowProgress"></i
    ></a>
  </div>
</div>
